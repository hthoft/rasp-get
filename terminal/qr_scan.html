<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kom&Gå Terminal</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/sweetalert-dark.css" rel="stylesheet" />
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background-color: #f8f9fa;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #container {
        width: 700px;
        height: 400px;
        background-image: url("assets/maprova-bg.png");
        background-size: cover;
        padding: 30px;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-around;
        text-align: center;
        border-radius: 8px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
      }

      #current-time {
        font-size: 2.5rem;
        font-weight: bold;
        color: #ffffff;
      }

      #welcome-message {
        font-size: 1.75rem;
        font-weight: bolder;
        margin-bottom: 10px;
      }

      #scan-prompt {
        font-size: 1.25rem;
        color: #dcdcdc;
      }

      #topBar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 40px;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 10;
        color: white;
        padding: 5px 10px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .icon-container {
        position: absolute;
        left: 10px;
        display: flex;
        gap: 10px;
      }

      #clock {
        color: white;
        font-size: 1.5rem;
      }
    </style>
  </head>
  <body>
    <div id="topBar" class="d-flex justify-content-between align-items-center">
      <div class="icon-container">
        <div id="usbIcon" class="icon" title="USB Status">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="18"
            height="18"
            fill="#f94f5f"
          >
            <path
              d="M15,7V11H16V13H13V5H15L12,1L9,5H11V13H8V10.93C8.7,10.56 9.2,9.85 9.2,9C9.2,7.78 8.21,6.8 7,6.8C5.78,6.8 4.8,7.78 4.8,9C4.8,9.85 5.3,10.56 6,10.93V13A2,2 0 0,0 8,15H11V18.05C10.29,18.41 9.8,19.15 9.8,20A2.2,2.2 0 0,0 12,22.2A2.2,2.2 0 0,0 14.2,20C14.2,19.15 13.71,18.41 13,18.05V15H16A2,2 0 0,0 18,13V11H19V7H15Z"
            />
          </svg>
        </div>
        <div id="wifiIcon" class="icon" title="WiFi Status">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="18"
            height="18"
            fill="#f94f5f"
          >
            <path
              d="M12,21L15.6,16.2C14.6,15.45 13.35,15 12,15C10.65,15 9.4,15.45 8.4,16.2L12,21M12,3C7.95,3 4.21,4.34 1.2,6.6L3,9C5.5,7.12 8.62,6 12,6C15.38,6 18.5,7.12 21,9L22.8,6.6C19.79,4.34 16.05,3 12,3M12,9C9.3,9 6.81,9.89 4.8,11.4L6.6,13.8C8.1,12.67 9.97,12 12,12C14.03,12 15.9,12.67 17.4,13.8L19.2,11.4C17.19,9.89 14.7,9 12,9Z"
            />
          </svg>
        </div>
        <div id="serverIcon" class="icon" title="Server Status">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="18"
            height="18"
            fill="#f94f5f"
          >
            <path
              d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
            />
          </svg>
        </div>
      </div>
      <div id="clock" class="text-center fw-light w-100">MAPROVA TERMINAL</div>
    </div>

    <div id="container">
      <div id="welcome-message">Velkommen!</div>
      <div id="scan-prompt">
        Scan din QR eller RFID for at registrere kom/gå tidspunkt.
      </div>
      <div id="current-time">Tid:</div>
      <div
        id="scan-result"
        class="text-success fw-bold"
        style="font-size: 1.5rem"
      ></div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/socket.io.js"></script>
    <script src="js/sweetalert.js"></script>
    <script>
      function formatDateTime() {
        const now = new Date();
        const options = {
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        };
        return now.toLocaleTimeString("da-DK", options);
      }

      // Update current time every second
      setInterval(() => {
        document.getElementById("current-time").textContent =
          "Tid: " + formatDateTime();
      }, 1000);

      let scanBuffer = ""; // Buffer to collect scan input

      // Listen for keypress events to capture scanner input
      window.addEventListener("keypress", (event) => {
        // Check if Enter key is pressed to trigger scan completion
        if (event.key === "Enter") {
          // Show SweetAlert with scan result and timestamp
          Swal.fire({
            icon: "success",
            title: "Registrering gennemført!",
            text: `Velkommen! ID: ${scanBuffer}\nTidspunkt: ${formatDateTime()}`,
            showConfirmButton: true,
            confirmButtonText: "OK",
            customClass: {
              popup: "animated fadeInDown",
            },
          });

          // Display scan result in the container
          document.getElementById(
            "scan-result"
          ).textContent = `ID Scanned: ${scanBuffer}`;

          // Clear the buffer after showing the result
          scanBuffer = "";
        } else {
          // Append each character to the buffer
          scanBuffer += event.key;
        }
      });
    </script>
  </body>
</html>
